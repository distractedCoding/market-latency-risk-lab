<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Market Latency Risk Lab</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <main class="shell">
    <header class="hero">
      <p class="eyebrow">Paper-Live Mode</p>
      <h1>Market Latency Risk Lab</h1>
      <p class="subtitle">BTC-only strategy dashboard with 15-minute forecast telemetry and live updates from <code>/ws/events</code>.</p>
      <p id="connection-status" class="pill state-pending">Connecting...</p>
    </header>

    <section class="kpi-strip" aria-label="top kpis">
      <article class="kpi-card">
        <p class="kpi-label">Balance</p>
        <p id="kpi-balance" class="kpi-value">$0.00</p>
      </article>
      <article class="kpi-card">
        <p class="kpi-label">Total P&amp;L</p>
        <p id="kpi-total-pnl" class="kpi-value">$0.00</p>
      </article>
      <article class="kpi-card">
        <p class="kpi-label">Exec Latency</p>
        <p id="kpi-exec-latency" class="kpi-value">0 us</p>
      </article>
      <article class="kpi-card">
        <p class="kpi-label">Win Rate</p>
        <p id="kpi-win-rate" class="kpi-value">0.0%</p>
      </article>
      <article class="kpi-card">
        <p class="kpi-label">BTC/USD</p>
        <p id="kpi-btc-usd" class="kpi-value">--</p>
      </article>
    </section>

    <section class="workspace-grid">
      <aside class="panel settings-panel">
        <h2>Strategy Settings</h2>
        <form id="settings-form" class="settings-form">
          <label class="field-label" for="settings-execution-mode">Execution Mode</label>
          <select id="settings-execution-mode" name="execution_mode">
            <option value="paper">paper</option>
            <option value="live">live</option>
          </select>

          <label class="checkbox-row" for="settings-trading-paused">
            <input id="settings-trading-paused" type="checkbox" name="trading_paused">
            <span>Trading Paused</span>
          </label>

          <label class="field-label" for="settings-lag-threshold">Lag Threshold %</label>
          <input id="settings-lag-threshold" name="lag_threshold_pct" type="number" min="0.01" step="0.01">

          <label class="field-label" for="settings-risk-per-trade">Risk Per Trade %</label>
          <input id="settings-risk-per-trade" name="risk_per_trade_pct" type="number" min="0.01" step="0.01">

          <label class="field-label" for="settings-daily-loss-cap">Daily Loss Cap %</label>
          <input id="settings-daily-loss-cap" name="daily_loss_cap_pct" type="number" min="0.01" step="0.01">

          <button id="settings-apply" type="submit">Apply Settings</button>
        </form>
        <div class="settings-meta">
          <p class="mono" id="settings-market">Market: BTC/USD</p>
          <p class="mono" id="settings-horizon">Forecast Horizon: 15m</p>
          <p class="mono" id="settings-status">Waiting for settings...</p>
        </div>
      </aside>

      <section class="middle-dashboard">
        <article class="panel forecast-panel">
          <div class="panel-header-row">
            <h2>BTC 15m Forecast</h2>
            <p id="forecast-updated" class="mono">Waiting for forecast...</p>
          </div>
          <div class="forecast-grid">
            <div>
              <p class="kpi-label">Current BTC/USD</p>
              <p id="forecast-current" class="kpi-value">--</p>
            </div>
            <div>
              <p class="kpi-label">Forecast BTC/USD</p>
              <p id="forecast-target" class="kpi-value">--</p>
            </div>
            <div>
              <p class="kpi-label">Delta</p>
              <p id="forecast-delta" class="kpi-value">0.00%</p>
            </div>
          </div>
        </article>

        <article class="panel chart-panel">
          <div class="panel-header-row">
            <h2>Equity Curve</h2>
            <p id="equity-latest" class="mono">equity: 0.00</p>
          </div>
          <canvas id="equity-chart" width="700" height="250" aria-label="equity chart"></canvas>
        </article>

        <article class="panel">
          <h2>Feed Health</h2>
          <p id="feed-health" class="mono">Waiting for feed snapshot...</p>
        </article>
      </section>

      <aside class="panel logs-panel">
        <h2>Execution Logs</h2>
        <div id="execution-logs" class="chat-log" aria-live="polite"></div>
      </aside>
    </section>
  </main>

  <script src="/static/app.js" defer></script>
</body>
</html>
